@page "/customers/delete/{id:int}"
@using StoreManagementBlazor.Models
@using StoreManagementBlazor.Services
@inject CustomerService CustomerService
@inject NavigationManager Navigation

@rendermode InteractiveServer

<h3>Xóa khách hàng</h3>

@if (customer == null)
{
    <div class="alert alert-warning">Không tìm thấy khách hàng.</div>
}
else
{
    <div class="alert alert-danger">
        <h4>Bạn có chắc chắn muốn xóa khách hàng này?</h4>
    </div>

    <dl class="row">
        <dt class="col-sm-3">Mã khách hàng</dt>
        <dd class="col-sm-9">@customer.CustomerId</dd>

        <dt class="col-sm-3">Tên khách hàng</dt>
        <dd class="col-sm-9">@customer.Name</dd>

        <dt class="col-sm-3">Số điện thoại</dt>
        <dd class="col-sm-9">@customer.Phone</dd>

        <dt class="col-sm-3">Email</dt>
        <dd class="col-sm-9">@customer.Email</dd>

        <dt class="col-sm-3">Địa chỉ</dt>
        <dd class="col-sm-9">@customer.Address</dd>
    </dl>

    <div class="mt-3">
        <button class="btn btn-secondary" @onclick="GoBack">Quay lại</button>
        <button class="btn btn-danger" @onclick="DeleteCustomer">Xóa</button>
    </div>
}

@code {
    [Parameter] public int id { get; set; }

    Customer? customer;

    protected override async Task OnInitializedAsync()
    {
        customer = await CustomerService.GetById(id);
        
    }

    async Task DeleteCustomer()
    {
        bool ok = await CustomerService.Delete(id);

        if (ok)
            Navigation.NavigateTo("/customers");
    }

    void GoBack() => Navigation.NavigateTo("/customers");
}
